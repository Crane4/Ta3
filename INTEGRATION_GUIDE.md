# دليل التكامل - Integration Guide

## نظرة عامة

تم دمج التطبيق مع باكند وموقع ويب لعرض الحوادث المستلمة في الوقت الفعلي.

## المكونات

1. **التطبيق (React Native)**: يكتشف الحوادث ويرسلها للباكند
2. **الباكند (Node.js/Express)**: يستقبل البيانات من التطبيق
3. **موقع الويب**: يعرض البيانات المستلمة في لوحة تحكم

## خطوات التشغيل

### 1. تشغيل الباكند

```bash
cd SA3/backend
npm install
npm start
```

الباكند سيعمل على: `http://localhost:3000`

### 2. الوصول لموقع الويب

افتح المتصفح على: `http://localhost:3000`

ستجد لوحة تحكم تعرض:
- إحصائيات الحوادث
- قائمة بجميع الحوادث المستلمة
- تحديث تلقائي كل 3 ثواني

### 3. إعداد التطبيق

1. افتح التطبيق
2. اذهب إلى **الإعدادات**
3. في قسم "إعدادات الطوارئ"، ستجد حقل **"عنوان الباكند"**
4. أدخل عنوان الباكند:
   - للاختبار على نفس الجهاز: `http://localhost:3000`
   - للاختبار من جهاز آخر: `http://[IP_ADDRESS]:3000`
     - مثال: `http://192.168.1.100:3000`

### 4. اختبار التكامل

1. شغّل الباكند
2. افتح موقع الويب في المتصفح
3. في التطبيق، اذهب لشاشة الكاميرا
4. اضغط "بدء المراقبة"
5. عندما يكتشف التطبيق حادث أو سلوك خطير، سيتم إرساله تلقائياً للباكند
6. ستظهر البيانات في موقع الويب فوراً

## API Endpoints

### POST /api/incidents
استقبال حادث من التطبيق

**Request:**
```json
{
  "incidentId": "INC-1234567890",
  "type": "accident",
  "message": "تم اكتشاف حادث مروري",
  "location": {
    "latitude": 24.7136,
    "longitude": 46.6753
  },
  "timestamp": "2024-01-01T12:00:00.000Z",
  "severity": "critical"
}
```

### GET /api/incidents
الحصول على جميع الحوادث المستلمة

### GET /api/stats
الحصول على إحصائيات الحوادث

## ملاحظات مهمة

1. **عنوان IP للباكند**: إذا كنت تختبر على جهاز محمول، استخدم عنوان IP لجهاز الكمبيوتر وليس `localhost`
2. **CORS**: الباكند يدعم CORS للسماح بالطلبات من التطبيق
3. **التخزين**: البيانات حالياً مخزنة في الذاكرة (Memory). لإنتاج حقيقي، استخدم قاعدة بيانات
4. **الأمان**: في الإنتاج، أضف المصادقة (Authentication) والتفويض (Authorization)

## استكشاف الأخطاء

### التطبيق لا يرسل البيانات
- تأكد من أن الباكند يعمل
- تحقق من عنوان الباكند في الإعدادات
- تأكد من أن التطبيق والكمبيوتر على نفس الشبكة (إذا كنت تستخدم IP)

### الموقع لا يعرض البيانات
- تأكد من أن الباكند يعمل
- افتح Developer Console في المتصفح للتحقق من الأخطاء
- تأكد من أن JavaScript مفعّل

### خطأ CORS
- الباكند يدعم CORS تلقائياً
- إذا استمرت المشكلة، تحقق من إعدادات CORS في `server.js`

